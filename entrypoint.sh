#!/bin/sh
# ä¸­æ–‡å‹å¥½å¯åŠ¨å…¥å£è„šæœ¬
# è®¾è®¡ï¼šåŽå°å¼‚æ­¥åˆå§‹åŒ–æµè§ˆå™¨ï¼›å½“å‰è¿›ç¨‹ä½œä¸ºä¸»è¿›ç¨‹åªç­‰å¾…ä»£ç†è¿›ç¨‹é€€å‡ºã€‚
# è¯´æ˜Žï¼šé¿å…ä½¿ç”¨ `wait -n` ä»¥ç¡®ä¿ /bin/sh(dash) å…¼å®¹æ€§ã€‚

set -eu

echo "=========================================="
echo "ðŸš€ å¯åŠ¨ Playwright MCP Server"
echo "=========================================="

# åŽå°å¼‚æ­¥åˆå§‹åŒ–æµè§ˆå™¨ï¼ˆè‹¥å·ä¸­ä¸å­˜åœ¨åˆ™ä»Žé•œåƒå¤‡ä»½å¤åˆ¶ï¼‰
(
  ./init-browser.sh
) &
INIT_PID=$!

# ç«‹å³å¯åŠ¨ä»£ç†æœåŠ¡å™¨ï¼ˆä¸ç­‰å¾…æµè§ˆå™¨å®Œå…¨å°±ç»ªï¼‰
node proxy-server.js &
PROXY_PID=$!

# ä»…ç­‰å¾…ä»£ç†è¿›ç¨‹ï¼›è‹¥ä»£ç†é€€å‡ºåˆ™æ¸…ç†åŽå°åˆå§‹åŒ–è¿›ç¨‹
wait "$PROXY_PID"
EXIT_CODE=$?
kill "$INIT_PID" 2>/dev/null || true
exit "$EXIT_CODE"
